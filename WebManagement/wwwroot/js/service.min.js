function base64Encode(n){var t,i,f,r,u,e;for(f=n.length,i=0,t="";i<f;){if(r=n.charCodeAt(i++)&255,i==f){t+=base64EncodeChars.charAt(r>>2);t+=base64EncodeChars.charAt((r&3)<<4);t+="==";break}if(u=n.charCodeAt(i++),i===f){t+=base64EncodeChars.charAt(r>>2);t+=base64EncodeChars.charAt((r&3)<<4|(u&240)>>4);t+=base64EncodeChars.charAt((u&15)<<2);t+="=";break}e=n.charCodeAt(i++);t+=base64EncodeChars.charAt(r>>2);t+=base64EncodeChars.charAt((r&3)<<4|(u&240)>>4);t+=base64EncodeChars.charAt((u&15)<<2|(e&192)>>6);t+=base64EncodeChars.charAt(e&63)}return t}function base64decode(n){var o,e,i,r,t,f,u;for(f=n.length,t=0,u="";t<f;){do o=base64DecodeChars[n.charCodeAt(t++)&255];while(t<f&&o===-1);if(o===-1)break;do e=base64DecodeChars[n.charCodeAt(t++)&255];while(t<f&&e===-1);if(e===-1)break;u+=String.fromCharCode(o<<2|(e&48)>>4);do{if(i=n.charCodeAt(t++)&255,i===61)return u;i=base64DecodeChars[i]}while(t<f&&i===-1);if(i===-1)break;u+=String.fromCharCode((e&15)<<4|(i&60)>>2);do{if(r=n.charCodeAt(t++)&255,r===61)return u;r=base64DecodeChars[r]}while(t<f&&r===-1);if(r===-1)break;u+=String.fromCharCode((i&3)<<6|r)}return u}function utf16to8En(n){n===null&&(n="");var i,r,u,t;for(i="",u=n.length,r=0;r<u;r++)t=n.charCodeAt(r),t>=1&&t<=127?i+=n.charAt(r):t>2047?(i+=String.fromCharCode(224|t>>12&15),i+=String.fromCharCode(128|t>>6&63),i+=String.fromCharCode(128|t>>0&63)):(i+=String.fromCharCode(192|t>>6&31),i+=String.fromCharCode(128|t>>0&63));return i}function utf8to16De(n){n===null&&(n="");var i,t,f,r,u,e;for(i="",f=n.length,t=0;t<f;){r=n.charCodeAt(t++);switch(r>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:i+=n.charAt(t-1);break;case 12:case 13:u=n.charCodeAt(t++);i+=String.fromCharCode((r&31)<<6|u&63);case 14:u=n.charCodeAt(t++);e=n.charCodeAt(t++);i+=String.fromCharCode((r&15)<<12|(u&63)<<6|(e&63)<<0)}}return i}function GetMgmtBus(n,t,i){"use strict";$.ajax({url:location.protocol+"//"+location.host+"/api/bus/GetBuses?UserID="+n+"&Session="+t,type:"GET",success:function(n){i(n)},error:function(){i(!1)}})}function GetName(n,t,i){"use strict";$.ajax({url:location.protocol+"//"+location.host+"/api/gen/GetName?UserID="+n,type:"GET",success:function(n){i(t,n)},error:function(){i(t,!1)}})}function GetStudents(n,t,i){"use strict";var r=getCookie("Session"),u=CryptoJS.SHA256(n+";;"+r+t+";;"+r).toString();$.ajax({url:location.protocol+"//"+location.host+"/api/bus/GetStudents?BusID="+n+"&TeacherID="+t+"&Session="+r+"&STAMP="+u,type:"GET",success:function(n){i(n)},error:function(){i(!1)}})}function QueryStudents(n,t,i,r){"use strict";var u=randomString(32),f=CryptoJS.SHA256(n+";;"+u+t+";"+i+";;"+u).toString();$.ajax({url:location.protocol+"//"+location.host+"api/bus/QueryStudents?BusID="+n+"&Column="+t+"&Content="+i+"&STAMP="+f+"&SALT="+u,type:"GET",success:function(n){n.ErrCode==="0"?r(n):r(!1)},error:function(){r(!1)}})}function UserNewReport(n,t,i,r,u){"use strict";$.ajax({url:location.protocol+"//"+location.host+"/api/gen/NewReport?BusID="+t+"&TeacherID="+n+"&ReportType="+i+"&Content="+r,type:"GET",success:function(n){n.ErrCode==="0"?u(n):u(!1)},error:function(){u(!1)}})}function SignStudent(n,t,i,r,u,f){"use strict";var e=getCookie("Session");$.ajax({url:location.protocol+"//"+location.host+"/api/bus/SignStudents?BusID="+t+"&SignData="+CryptoJS.SHA256(u+e+";"+r+t+n).toString()+"&Data="+base64Encode(utf16to8En(r+";"+u+";"+e+";"+n+";"+i)),type:"GET",success:function(n){f(n)},error:function(){f(!1)}})}function GetClassStudents(n,t,i){"use strict";$.ajax({url:location.protocol+"//"+location.host+"/api/class/getStudents?ClassID="+n+"&TeacherID="+t,type:"GET",success:function(n){i(n)},error:function(){i(!1)}})}function GetMyChild(n,t){"use strict";$.ajax({url:location.protocol+"//"+location.host+"/api/parent/getMyChild?parentId="+n,type:"GET",success:function(n){t(n)},error:function(){t(!1)}})}function randomString(n){"use strict";var t;n=n||16;var i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz1234567890",u=i.length,r="";for(t=0;t<n;t++)r+=i.charAt(Math.floor(Math.random()*u));return r}function InitJSSDK(n){"use strict";var t=randomString(32),i=(new Date).getTime(),r=location.href,u="jsapi_ticket="+n+"&noncestr="+t+"&timestamp="+i+"&url="+r,f=hex_sha1(u);wx.config({debug:!1,appId:"wx68bec13e85ca6465",timestamp:i,nonceStr:t,signature:f,jsApiList:["checkJsApi","onMenuShareTimeline","onMenuShareAppMessage","onMenuShareQQ","onMenuShareWeibo","onMenuShareQZone","hideMenuItems","showMenuItems","hideAllNonBaseMenuItem","showAllNonBaseMenuItem","translateVoice","startRecord","stopRecord","onVoiceRecordEnd","playVoice","onVoicePlayEnd","pauseVoice","stopVoice","uploadVoice","downloadVoice","chooseImage","previewImage","uploadImage","downloadImage","getNetworkType","openLocation","getLocation","hideOptionMenu","showOptionMenu","closeWindow","scanQRCode","chooseWXPay","openProductSpecificView","addCard","chooseCard","openCard"]})}function setCookie(n,t){var i=new Date;i.setTime(i.getTime()+24e5);document.cookie=n+"="+escape(t)+";expires="+i.toUTCString()+";path=/"}function getCookie(n){var t,i=new RegExp("(^| )"+n+"=([^;]*)(;|$)");return(t=document.cookie.match(i))?unescape(t[2]):null}function delCookie(n){var t=new Date,i;t.setTime(t.getTime()-1);i=getCookie(n);i!==null&&(document.cookie=n+"=nothing;expires="+t.toUTCString()+";path=/")}function GetURLOption(n){"use strict";var i=new RegExp("(^|&)"+n+"=([^&]*)(&|$)"),t=location.href.substr(location.href.indexOf("?")+1).match(i);return t===null?"nullStr":t[2]}var base64EncodeChars="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",base64DecodeChars=[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,-1,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,-1,-1,-1,-1,-1];wx.error(function(n){"use strict";n.errMsg.indexOf("invalid signature")>-1?(alert(n.errMsg.indexOf("调用签名不正确")),console.log("Signature Failed"),InitWeixin(!0)):alert(n.errMsg)});